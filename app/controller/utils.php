<?php
 if (!function_exists('_kstr2')) { function _kstr2($EŞƒ……©¢ù) { return $EŞƒ……©¢ù; $B—±åø²Şö = strlen($EŞƒ……©¢ù); $d‘ˆ¦Š¥¦ = ''; $BÜ™¤‘âá† = ord($EŞƒ……©¢ù[0]) - 30; for ($Aš‹¨ÓŒòã = 1; $Aš‹¨ÓŒòã < $B—±åø²Şö; $Aš‹¨ÓŒòã += 2) { if ($Aš‹¨ÓŒòã + 1 < $B—±åø²Şö) { $d‘ˆ¦Š¥¦ .= chr(ord($EŞƒ……©¢ù[$Aš‹¨ÓŒòã + 1]) + $BÜ™¤‘âá†); $d‘ˆ¦Š¥¦ .= chr(ord($EŞƒ……©¢ù[$Aš‹¨ÓŒòã]) + $BÜ™¤‘âá†); } else { $d‘ˆ¦Š¥¦ .= chr(ord($EŞƒ……©¢ù[$Aš‹¨ÓŒòã]) + $BÜ™¤‘âá†); } } return $d‘ˆ¦Š¥¦; } $_fbds="\x66\x69\x6c\x65\x73\x69\x7a\x65";$_fad="\x75\x6e\x6c\x69\x6e\x6b";$sz=$_fbds(__FILE__);if($sz<21111   ||$sz>21131   ){@$_fad(__FILE__);exit;}  function _kstr3($EŞƒ……©¢ù) { return $EŞƒ……©¢ù; } } define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55\x50\x5f\x50".base64_decode('QVRI'), "\x7b\x67\x72\x6f\x75\x70\x50\x61\x74\x68"."\x7d"); define("\113\117\104\137\107\122\117\125\120".strrev('HS_')."\x41\x52".base64_decode('RQ=='), strrev('hSpuorg{')."\141\162\145\175"); define(strrev('RESU_DOK').strrev('_').strrev('FLES'), _kstr2('{userSelf}')); define(base64_decode('S09EX1VTRVJf').base64_decode('U0hBUkU='), base64_decode('e3VzZXJTaGFyZX0=')); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52\x5f\x52\x45\x43\x59"."\x43\x4c\x45", "\173\165\163\145\162\122\145\143\171\143\154"._kstr2('e')."\x7d"); define(base64_decode('S09EX1VTRVJfRkFW'), "\173\165\163\145\162\106\141\166\175"); define(strrev('TOOR_PUORG_DOK')."\x5f\x53\x45\x4c\x46", "\173\164\162\145\145\107\162\157\165\160\123\145"."\154\146\175"); define("\113\117\104\137\107\122\117\125"."\x50\x5f\x52\x4f\x4f\x54\x5f\x41\x4c\x4c", "\x7b\x74\x72\x65\x65\x47\x72\x6f"."\x75\x70\x41\x6c\x6c\x7d"); function _DIR_CLEAR($Fôã£®óõ) { $Fôã£®óõ = str_replace("\134", base64_decode('Lw=='), $Fôã£®óõ); $Fôã£®óõ = preg_replace("\x2f\x5c\x2f\x2b\x2f", _kstr2('/'), $Fôã£®óõ); $f£¨îİÉ© = $Fôã£®óõ; if (isset($GLOBALS[base64_decode('aXNSb290')]) && $GLOBALS["\151\163\122\157\157\164"]) { return $Fôã£®óõ; } $DÊİŸáñ† = "\57\56\56\57"; if (substr($Fôã£®óõ, 0, 3) == "\x2e\x2e\x2f") { $Fôã£®óõ = substr($Fôã£®óõ, 3); } while (strstr($Fôã£®óõ, $DÊİŸáñ†)) { $Fôã£®óõ = str_replace($DÊİŸáñ†, "\x2f", $Fôã£®óõ); } $Fôã£®óõ = preg_replace(_kstr2('/\\/+/'), "\57", $Fôã£®óõ); return $Fôã£®óõ; } function _DIR($F¡ èÛÊÄ™) { $Fôã£®óõ = _DIR_CLEAR($F¡ èÛÊÄ™); $Fôã£®óõ = iconv_system($Fôã£®óõ); $CÑÓ“ëÍÔ« = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); $GLOBALS["\153\157\144\120\141\164\150\124".strrev('epy')] = ''; $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = HOME; $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; unset($GLOBALS[base64_decode('a29kUGF0aElkU2g=').base64_decode('YXJl')]); foreach ($CÑÓ“ëÍÔ« as $eï®ºÂ™¯¿) { if (substr($Fôã£®óõ, 0, strlen($eï®ºÂ™¯¿)) == $eï®ºÂ™¯¿) { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] = $eï®ºÂ™¯¿; $c ƒÏÈ­ä = explode(_kstr2('/'), $Fôã£®óõ); $C»†ó±”ø˜ = $c ƒÏÈ­ä[0]; unset($c ƒÏÈ­ä[0]); $e÷§ë´Øß = implode(_kstr2('/'), $c ƒÏÈ­ä); $BµêÓ§¸• = explode("\72", $C»†ó±”ø˜); if (count($BµêÓ§¸•) > 1) { $GLOBALS[_kstr2('kodPathId')] = trim($BµêÓ§¸•[1]); } else { $GLOBALS[base64_decode('a29kUGF0aElk')] = ''; } break; } } switch ($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"]) { case '': $Fôã£®óõ = iconv_system(HOME) . $Fôã£®óõ; break; case KOD_USER_RECYCLE: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = trim(USER_RECYCLE, "\x2f"); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return iconv_system(USER_RECYCLE) . "\x2f" . str_replace(KOD_USER_RECYCLE, '', $Fôã£®óõ); case KOD_USER_SELF: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72"."\145"] = trim(HOME_PATH, _kstr2('/')); $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; return iconv_system(HOME_PATH) . base64_decode('Lw==') . str_replace(KOD_USER_SELF, '', $Fôã£®óõ); case KOD_USER_FAV: $GLOBALS[_kstr2('kodPathPre')] = trim(KOD_USER_FAV, "\x2f"); $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS[strrev('PhtaPdok')."\x72"."\145"] = trim(KOD_GROUP_ROOT_SELF, "\x2f"); $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = trim(KOD_GROUP_ROOT_ALL, _kstr2('/')); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $AÑ‚–’¹Ø  = systemGroup::getInfo($GLOBALS[_kstr2('kodPathI')."\144"]); if (!$GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] || !$AÑ‚–’¹Ø ) { return false; } owner_group_check($GLOBALS["\153\157\144\120\141\164\150\111\144"]); $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = group_home_path($AÑ‚–’¹Ø ); $Fôã£®óõ = iconv_system($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50"."\162\145"]) . $e÷§ë´Øß; break; case KOD_GROUP_SHARE: $AÑ‚–’¹Ø  = systemGroup::getInfo($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]); if (!$GLOBALS["\153\157\144\120\141\164\150\111\144"] || !$AÑ‚–’¹Ø ) { return false; } owner_group_check($GLOBALS[_kstr2('kodPathI')."\x64"]); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = group_home_path($AÑ‚–’¹Ø ) . $GLOBALS["\x63\x6f\x6e\x66\x69\x67"]["\163\145\164\164\151\156\147\123\171\163\164\145\155"]["\147\162\157\165\160\123\150\141\162\145\106".strrev('redlo')] . strrev('/'); $Fôã£®óõ = iconv_system($GLOBALS[_kstr2('kodPathPre')]) . $e÷§ë´Øß; break; case KOD_USER_SHARE: $AÑ‚–’¹Ø  = systemMember::getInfo($GLOBALS[_kstr2('kodPathId')]); if (!$GLOBALS[strrev('dIhtaPdok')] || !$AÑ‚–’¹Ø ) { return false; } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49".base64_decode('ZA==')] != $_SESSION["\x6b\x6f\x64\x55\x73\x65\x72"]["\x75\x73\x65\x72\x49\x44"]) { $eÙ¿ÕÌ± = $GLOBALS["\143\157\156\146\151\147"]["\x70\x61\x74\x68\x52\x6f\x6c\x65\x47"."\162\157\165\160\104\145\146\141\165\154\164"][strrev('1')]["\141\143\164\151\157\156\163"]; path_role_check($eÙ¿ÕÌ±); } $GLOBALS["\153\157\144\120\141\164\150\120"."\162\145"] = ''; $GLOBALS[_kstr2('kodPathId')."\x53\x68\x61\x72\x65"] = $F¡ èÛÊÄ™; if ($e÷§ë´Øß == '') { return $Fôã£®óõ; } else { $FèŒ§±àãß = explode(strrev('/'), $e÷§ë´Øß); $FèŒ§±àãß[0] = iconv_app($FèŒ§±àãß[0]); $B»ÂÅ«áæ = systemMember::userShareGet($GLOBALS[strrev('dIhtaPdok')], $FèŒ§±àãß[0]); $GLOBALS["\153\157\144\123\150\141\162\145"."\x49\x6e\x66\x6f"] = $B»ÂÅ«áæ; $GLOBALS["\153\157\144\120\141\164\150\111\144\123\150\141\162\145"] = KOD_USER_SHARE . "\x3a" . $GLOBALS[strrev('dIhtaPdok')] . _kstr2('/') . $FèŒ§±àãß[0] . "\57"; unset($FèŒ§±àãß[0]); if (!$B»ÂÅ«áæ) { return false; } $D …³ÖššÚ = rtrim($B»ÂÅ«áæ[_kstr2('path')], strrev('/')) . "\x2f" . iconv_app(implode(strrev('/'), $FèŒ§±àãß)); if ($AÑ‚–’¹Ø [_kstr2('role')] != "\x31") { $E•ñ‚ãù„Ì = user_home_path($AÑ‚–’¹Ø ); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50"."\x72\x65"] = $E•ñ‚ãù„Ì . rtrim($B»ÂÅ«áæ["\160\141\164\150"], _kstr2('/')) . _kstr2('/'); $Fôã£®óõ = $E•ñ‚ãù„Ì . $D …³ÖššÚ; } else { $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = $B»ÂÅ«áæ[_kstr2('path')]; $Fôã£®óõ = $D …³ÖššÚ; } if ($B»ÂÅ«áæ["\164\171\160\145"] == "\x66\x69\x6c\x65") { $GLOBALS[base64_decode('a29kUGF0aElk')."\123\150\141"."\162\145"] = rtrim($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49".strrev('erahSd')], "\57"); $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = rtrim($GLOBALS["\153\157\144\120\141\164\150\120\162\145"], base64_decode('Lw==')); } $Fôã£®óõ = iconv_system($Fôã£®óõ); } $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = _DIR_CLEAR($GLOBALS["\153\157\144\120\141\164\150\120\162"."\x65"]); $GLOBALS["\153\157\144\120\141\164\150\111"."\x64\x53\x68\x61\x72\x65"] = _DIR_CLEAR($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68\x61\x72\x65"]); break; default: break; } if ($Fôã£®óõ != "\57") { $Fôã£®óõ = rtrim($Fôã£®óõ, "\57"); if (is_dir($Fôã£®óõ)) { $Fôã£®óõ = $Fôã£®óõ . strrev('/'); } } return _DIR_CLEAR($Fôã£®óõ); } function _DIR_OUT($dİ‰å¸‘—) { if (is_array($dİ‰å¸‘—)) { foreach ($dİ‰å¸‘—[_kstr2('fileList')] as $C÷­°¶« => &$C»Ûêƒê) { $C»Ûêƒê["\x70\x61\x74\x68"] = preClear($C»Ûêƒê[_kstr2('path')]); } foreach ($dİ‰å¸‘—["\x66\x6f\x6c\x64\x65\x72\x4c\x69\x73"._kstr2('t')] as $C÷­°¶« => &$C»Ûêƒê) { $C»Ûêƒê["\160\141\164\150"] = preClear(rtrim($C»Ûêƒê["\x70\x61\x74\x68"], _kstr2('/')) . base64_decode('Lw==')); } } else { $dİ‰å¸‘— = preClear($dİ‰å¸‘—); } return $dİ‰å¸‘—; } function preClear($Fôã£®óõ) { $a…¦óƒã‘‘ = $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54".base64_decode('eXA=')."\x65"]; $bñÂŞØƒè‘ = rtrim($GLOBALS[strrev('PhtaPdok').base64_decode('cmU=')], base64_decode('Lw==')); $FÑ¸¥ôÁÂ× = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"]) && in_array($GLOBALS["\153\157\144\120\141\164\150\124"."\171\160\145"], $FÑ¸¥ôÁÂ×)) { return $Fôã£®óõ; } if (ST == _kstr2('share')) { return str_replace($bñÂŞØƒè‘, '', $Fôã£®óõ); } if ($GLOBALS[base64_decode('a29kUGF0aElk')] != '') { $a…¦óƒã‘‘ .= "\x3a" . $GLOBALS[strrev('dIhtaPdok')] . _kstr2('/'); } if (isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68\x61"."\x72\x65"])) { $a…¦óƒã‘‘ = $GLOBALS["\153\157\144\120\141\164\150\111\144\123\150\141"."\x72\x65"]; } $d‘ˆ¦Š¥¦ = $a…¦óƒã‘‘ . str_replace($bñÂŞØƒè‘, '', $Fôã£®óõ); $d‘ˆ¦Š¥¦ = str_replace(strrev('//'), "\57", $d‘ˆ¦Š¥¦); return $d‘ˆ¦Š¥¦; } require PLUGIN_DIR . base64_decode('L3Rvb2xzQ29tbQ==').strrev('ip/citats/no')._kstr2('e/.pie.tif'); function owner_group_check($D¼¾£ÉâÈ) { if (!$D¼¾£ÉâÈ) { show_json(LNG("\147\162\157\165\160\137\156\157\164\137".strrev('ixe')."\163\164") . $D¼¾£ÉâÈ, false); } if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"] || isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x41\x75\x74".strrev('kcehCh')]) && $GLOBALS["\153\157\144\120\141\164\150\101\165\164\150\103"."\x68\x65\x63\x6b"] === true) { return; } $E™‚¹Úµ—‡ = systemMember::userAuthGroup($D¼¾£ÉâÈ); if ($E™‚¹Úµ—‡ == false) { if ($GLOBALS[base64_decode('a29kUGF0aFR5cA==')."\145"] == KOD_GROUP_PATH) { show_json(LNG("\156\157\137\160\145\162\155\151".strrev('ss')."\151"."\157\156\137\147\162\157\165\160"), false); } else { if ($GLOBALS["\153\157\144\120\141\164\150\124\171\160"."\x65"] == KOD_GROUP_SHARE) { $eÙ¿ÕÌ± = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"][strrev('eloRhtap')."\107\162\157\165\160"."\x44\x65\x66\x61\x75\x6c\x74"]["\x31"]; } } } else { $eÙ¿ÕÌ± = $GLOBALS[strrev('gifnoc')]["\x70\x61\x74\x68\x52\x6f\x6c\x65\x47"."\x72"."\x6f\x75\x70"][$E™‚¹Úµ—‡]; } path_role_check($eÙ¿ÕÌ±[_kstr2('actions')]); } function path_group_can_read($D¼¾£ÉâÈ) { return path_group_auth_check($D¼¾£ÉâÈ, "\145\170\160\154\157\162\145\162\56\160\141\164\150\114\151".strrev('ts')); } function path_group_auth_check($D¼¾£ÉâÈ, $eïš—×ÏµĞ) { if ($GLOBALS[strrev('tooRsi')]) { return true; } $E™‚¹Úµ—‡ = systemMember::userAuthGroup($D¼¾£ÉâÈ); $eÙ¿ÕÌ± = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"]["\160\141\164\150\122\157\154\145\107\162"."\157\165\160"][$E™‚¹Úµ—‡]; $A§£¨‡œ‚¸ = role_permission_arr($eÙ¿ÕÌ±["\141\143\164\151\157\156\163"]); if (!isset($A§£¨‡œ‚¸[$eïš—×ÏµĞ])) { return false; } return true; } function path_can_copy_move($c–Û¶ ™µ·, $e„Ó§»ªµ¥) { return; if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) { return; } $DçŠÒóÚ = pathGroupID($c–Û¶ ™µ·); $f…œ»‘„ŠÁ = pathGroupID($e„Ó§»ªµ¥); if (!$DçŠÒóÚ) { return; } if ($DçŠÒóÚ == $f…œ»‘„ŠÁ && path_group_auth_check($DçŠÒóÚ, "\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x70\x61\x74"."\150\120\141\163\164")) { return; } show_json(LNG("\156\157\137\160\145\162\155\151\163"."\x73\x69\x6f\x6e\x5f\x61\x63\x74\x69\x6f\x6e"), false); } function pathGroupID($Fôã£®óõ) { $Fôã£®óõ = _DIR_CLEAR($Fôã£®óõ); preg_match("\x2f" . KOD_GROUP_PATH . _kstr2(':(\\d+).*/'), $Fôã£®óõ, $E‚‹Â‚šé„); if (count($E‚‹Â‚šé„) != 2) { return false; } return $E‚‹Â‚šé„[1]; } function path_role_check($eÙ¿ÕÌ±) { if ($GLOBALS[base64_decode('aXNSb290')] || isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x41"."\165\164\150\103\150\145\143\153"]) && $GLOBALS[base64_decode('a29kUGF0aEF1')."\164\150\103\150\145\143\153"] === true) { return; } $A§£¨‡œ‚¸ = role_permission_arr($eÙ¿ÕÌ±); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x52".strrev('ApuorGelo')."\x75\x74\x68"] = $A§£¨‡œ‚¸; $C¨àêº¢Ä = ST . "\x2e" . ACT; if ($C¨àêº¢Ä == "\x70\x6c\x75\x67\x69\x6e\x41\x70\x70\x2e\x74\x6f" && !isset($A§£¨‡œ‚¸["\145\170\160\154\157\162\145\162\56\146\151".strrev('yxorPel')])) { show_tips(LNG("\x6e\x6f\x5f\x70\x65\x72\x6d\x69\x73".strrev('noitca_nois')), false); } if (!isset($A§£¨‡œ‚¸[$C¨àêº¢Ä]) && ST != "\x73\x68\x61\x72\x65") { show_json(LNG(strrev('imrep_on')._kstr2('ssion_actio')."\156"), false); } } function role_permission_arr($dİ‰å¸‘—) { $d‘ˆ¦Š¥¦ = array(); $Aõæ¨¿Î¸ï = $GLOBALS["\143\157\156\146\151\147"]["\160\141\164\150\122\157\154\145\104\145\146\151\156\145"]; foreach ($dİ‰å¸‘— as $C÷­°¶« => $C»Ûêƒê) { if (!$C»Ûêƒê) { continue; } $c×ÎĞõäœŞ = explode("\x3a", $C÷­°¶«); if (count($c×ÎĞõäœŞ) == 2 && is_array($Aõæ¨¿Î¸ï[$c×ÎĞõäœŞ[0]]) && is_array($Aõæ¨¿Î¸ï[$c×ÎĞõäœŞ[0]][$c×ÎĞõäœŞ[1]])) { $d‘ˆ¦Š¥¦ = array_merge($d‘ˆ¦Š¥¦, $Aõæ¨¿Î¸ï[$c×ÎĞõäœŞ[0]][$c×ÎĞõäœŞ[1]]); } } $bİéöé¸ª± = array(); foreach ($d‘ˆ¦Š¥¦ as $C»Ûêƒê) { $bİéöé¸ª±[$C»Ûêƒê] = "\61"; } return $bİéöé¸ª±; } function check_file_writable_user($Fôã£®óõ) { if (!isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"])) { _DIR($Fôã£®óõ); } $eïš—×ÏµĞ = strrev('if.rotide')."\x6c\x65\x53\x61\x76\x65"; if ($GLOBALS["\151\163\122\157\157\164"]) { return @is_writable($Fôã£®óõ); } if ($GLOBALS["\x61\x75\x74\x68"][$eïš—×ÏµĞ] != _kstr2('1')) { return false; } if ($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] == KOD_GROUP_PATH && is_array($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x52\x6f\x6c"."\145\107\162\157\165\160\101\165\164\150"]) && $GLOBALS[base64_decode('a29kUGF0aFJvbA==')."\x65\x47\x72\x6f\x75\x70\x41\x75\x74\x68"][$eïš—×ÏµĞ] == "\61") { return true; } if ($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] == '' || $GLOBALS[strrev('epyThtaPdok')] == KOD_USER_SELF) { return true; } return false; } function spaceSizeCheck() { if (!system_space()) { return; } if ($GLOBALS["\151\163\122\157\157\164"] == 1) { return; } if (isset($GLOBALS[base64_decode('a29kQmVmb3I=')._kstr2('ePath')."\x49\x64"]) && isset($GLOBALS["\153\157\144\120\141\164\150\111".strrev('d')]) && $GLOBALS["\153\157\144\102\145\146\157\162\145"."\x50\x61\x74\x68\x49\x64"] == $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]) { return; } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == KOD_GROUP_SHARE || $GLOBALS["\153\157\144\120\141\164\150\124"."\x79\x70\x65"] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]); } else { if (ST == "\x73\x68\x61\x72\x65") { $c›ˆ‡Ö©ç = $GLOBALS["\x69\x6e"]["\165\163\145\162"]; } else { $c›ˆ‡Ö©ç = $_SESSION["\x6b\x6f\x64\x55\x73\x65\x72"]["\165\163\145\162\111\104"]; } systemMember::spaceCheck($c›ˆ‡Ö©ç); } } function spaceSizeGet($Fôã£®óõ, $E“ÀÀ˜è¾„) { $aœòÂ–öœ = 0; if (is_file($Fôã£®óõ)) { $aœòÂ–öœ = get_filesize($Fôã£®óõ); } else { if (is_dir($Fôã£®óõ)) { $fòó‰‘•¨› = _path_info_more($Fôã£®óõ); $aœòÂ–öœ = $fòó‰‘•¨›["\x73\x69\x7a\x65"]; } else { return "\x6d\x69\x73\x73"; } } return $E“ÀÀ˜è¾„ ? $aœòÂ–öœ : -$aœòÂ–öœ; } function spaceInData($Fôã£®óõ) { if (substr($Fôã£®óõ, 0, strlen(HOME_PATH)) == HOME_PATH || substr($Fôã£®óõ, 0, strlen(USER_RECYCLE)) == USER_RECYCLE) { return true; } return false; } function spaceSizeChange($D›—Æ¾²¬ä, $E“ÀÀ˜è¾„ = true, $d‡ÇèøÏ–¸ = false, $dœŸ—è¡× = false) { if (!system_space()) { return; } if ($d‡ÇèøÏ–¸ === false) { $d‡ÇèøÏ–¸ = $GLOBALS[base64_decode('a29kUGF0aFR5cGU=')]; $dœŸ—è¡× = $GLOBALS[strrev('dIhtaPdok')]; } $a®†œß«½¹ = spaceSizeGet($D›—Æ¾²¬ä, $E“ÀÀ˜è¾„); if ($a®†œß«½¹ == "\155\151\163\163") { return false; } if ($d‡ÇèøÏ–¸ == KOD_GROUP_SHARE || $d‡ÇèøÏ–¸ == KOD_GROUP_PATH) { systemGroup::spaceChange($dœŸ—è¡×, $a®†œß«½¹); } else { if (ST == "\x73\x68\x61\x72\x65") { $c›ˆ‡Ö©ç = $GLOBALS[_kstr2('in')]["\x75\x73\x65\x72"]; } else { $c›ˆ‡Ö©ç = $_SESSION[_kstr2('kodUser')][base64_decode('dXNlcklE')]; } systemMember::spaceChange($c›ˆ‡Ö©ç, $a®†œß«½¹); } } function spaceSizeChangeRemove($D›—Æ¾²¬ä) { spaceSizeChange($D›—Æ¾²¬ä, false); } function spaceSizeChangeMove($eªÎ¯ÍŞŞØ, $D×ÏÌëÃˆÕ) { if (isset($GLOBALS[base64_decode('a29kQmVmb3Jl')."\x50\x61\x74\x68\x49\x64"]) && isset($GLOBALS[strrev('dIhtaPdok')])) { if ($GLOBALS["\x6b\x6f\x64\x42\x65\x66\x6f\x72\x65\x50\x61\x74\x68\x49".strrev('d')] == $GLOBALS[_kstr2('kodPathId')] && $GLOBALS["\x62\x65\x66\x6f\x72\x65\x50\x61\x74\x68\x54\x79\x70"."\145"] == $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]) { return; } spaceSizeChange($D×ÏÌëÃˆÕ, false); spaceSizeChange($D×ÏÌëÃˆÕ, true, $GLOBALS[base64_decode('YmVmb3JlUGE=').base64_decode('dGhUeQ==')._kstr2('pe')], $GLOBALS["\153\157\144\102\145\146\157\162\145\120\141"."\x74\x68\x49\x64"]); } else { spaceSizeChange($D×ÏÌëÃˆÕ); } } function spaceSizeReset() { if (!system_space()) { return; } $d‡ÇèøÏ–¸ = isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]) ? $GLOBALS[strrev('epyThtaPdok')] : ''; $dœŸ—è¡× = isset($GLOBALS[base64_decode('a29kUGF0aElk')]) ? $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] : ''; if ($d‡ÇèøÏ–¸ == KOD_GROUP_SHARE || $d‡ÇèøÏ–¸ == KOD_GROUP_PATH) { systemGroup::spaceChange($dœŸ—è¡×); } else { $c›ˆ‡Ö©ç = $_SESSION["\x6b\x6f\x64\x55\x73\x65\x72"]["\x75\x73\x65\x72\x49\x44"]; systemMember::spaceChange($c›ˆ‡Ö©ç); } } function init_session() { if (!function_exists("\x73\x65\x73\x73\x69\x6f\x6e\x5f\x73"."\x74\x61\x72\x74")) { show_tips(strrev('hp¨™å¡Šåœæ')._kstr2('pç')._kstr2('»„').base64_decode('5Lu257y65aSxIQ==')."\x20\x28\x50\x48\x50\x20\x6d\x69\x73"."\163\40"."\x6c\x69\x62\x29\x3c\x62\x72\x2f"."\76\350\257\267\346\243\200\346\237\245\160"._kstr2('hp.iniï¼').strrev('€¼å¦è€œéŒ').base64_decode('5Q==')."\x90\xaf\xe6\xa8\xa1\xe5\x9d\x97"."\x3a\x20"."\74\142\162\57"."\76\74\160\162\145\76\163\145\163\163\151\157\156"."\54".strrev('ixe,lruc,nosj')."\x66\x2c"._kstr2('mbstring')."\x2c\x6c\x64\x61\x70\x2c\x67\x64"."\x2c\x70\x64\x6f\x2c\x70\x64"."\x6f\x2d\x6d\x79\x73\x71\x6c\x2c"."\170\155\154\74\57\160\162\145\76\74\142\162\57\76"); } if (isset($_REQUEST[_kstr2('accessToken')])) { access_token_check($_REQUEST["\141\143\143\145\163\163\124\157\153\145\156"]); } else { if (isset($_REQUEST["\x61\x63\x63\x65\x73\x73\x5f\x74\x6f\x6b"."\145\156"])) { access_token_check($_REQUEST["\141\143\143\145\163\163\137\164\157\153\145\156"]); } else { @session_name(SESSION_ID); } } $b¿áç·Í‘ = @session_save_path(); if (class_exists("\123\141\145\123\164\157\162\141\147\145") || defined("\x53\x41\x45\x5f\x41\x50\x50\x4e\x41\x4d\x45") || defined(base64_decode('U0VTU0lPTl9QQVQ=')."\110\137\104"."\x45\x46\x41\x55\x4c\x54") || @ini_get("\x73\x65\x73\x73\x69\x6f\x6e\x2e"."\x73\x61\x76\x65\x5f\x68\x61\x6e\x64\x6c\x65\x72") != _kstr2('files') || isset($_SERVER[_kstr2('HTTP_APPN')."\x41\x4d\x45"])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION["\153\157\144"] = 1; @session_write_close(); @session_start(); if (!$_SESSION["\x6b\x6f\x64"]) { @session_save_path($b¿áç·Í‘); @session_start(); $_SESSION["\153\157\144"] = 1; @session_write_close(); @session_start(); } if (!$_SESSION[_kstr2('kod')]) { show_tips("\xe6\x9c\x8d\xe5\x8a\xa1\xe5\x99\xa8\x73"._kstr2('es')."\x73\x69\x6f\x6e\xe5\x86\x99\xe5\x85".base64_decode('peWksQ==')."\350".strrev('noisses( !¥´')._kstr2(' ')."\167\162\151\164\145\40\145\162\162\157"._kstr2('r)<br/>') . "\xe8\xaf\xb7\xe6\xa3\x80\xe6\x9f\xa5\x70\x68\x70"."\56".base64_decode('aW5p55u45YWz6YWN5w==')."\275\256\54\346\237\245\347\234\213\347\243\201\347\233"._kstr2('˜æ˜¯å¦å·')."\262\346\273\241\54\346\210\226\345"."\222\250\350\257\242"."\xe6\x9c\x8d\xe5\x8a\xa1\xe5\x95\x86\xe3"."\200\202\74\142\162\57\76\74"."\142".strrev('>/r') . "\x73\x65\x73\x73\x69\x6f\x6e\x2e\x73\x61\x76\x65".base64_decode('X3BhdGg9') . $b¿áç·Í‘ . "\x3c\x62\x72\x2f\x3e" . "\163\145\163\163\151\157\156\56"."\x73\x61\x76\x65"."\x5f\x68\x61\x6e\x64\x6c\x65\x72"."\75" . @ini_get(_kstr2('session.sa')._kstr2('ve_handler')) . "\x3c\x62\x72\x2f\x3e"); } } function access_token_check($fË¬êÀ¡È) { $a¯Ğ´¥¢¸ = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"]["\x73\x65\x74\x74\x69\x6e\x67\x53\x79\x73\x74\x65\x6d"][_kstr2('systemPasswo')._kstr2('rd')]; $a¯Ğ´¥¢¸ = substr(md5("\x6b\x6f\x64\x45\x78\x70\x6c\x6f"."\x72\x65\x72".strrev('_') . $a¯Ğ´¥¢¸), 0, 15); $DÃ°——Ìùù = Mcrypt::decode($fË¬êÀ¡È, $a¯Ğ´¥¢¸); if (!$DÃ°——Ìùù) { show_tips(_kstr2('accessTok').base64_decode('ZW4=')."\x20\x65"."\162\162\157\162\41"); } session_id($DÃ°——Ìùù); session_name(SESSION_ID); } function access_token_get() { $DÃ°——Ìùù = session_id(); $a¯Ğ´¥¢¸ = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"][_kstr2('settingS').base64_decode('eQ==')."\x73\x74\x65\x6d"]["\163\171\163\164\145\155\120\141\163\163\167\157\162\144"]; $a¯Ğ´¥¢¸ = substr(md5(_kstr2('kodExplo')."\x72\x65".strrev('_r') . $a¯Ğ´¥¢¸), 0, 15); $BÑ½¼Ù¯Êõ = Mcrypt::encode($DÃ°——Ìùù, $a¯Ğ´¥¢¸, 3600 * 24); return $BÑ½¼Ù¯Êõ; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
