<?php
 if (!function_exists('_kstr2')) { function _kstr2($EÂ“­–çÙ») { return $EÂ“­–çÙ»; $Fîô©Í¸‰å = strlen($EÂ“­–çÙ»); $a„Å·¶¼ˆç = ''; $d‹†Â“¡Å = ord($EÂ“­–çÙ»[0]) - 30; for ($bšÕ†¿Ò‚° = 1; $bšÕ†¿Ò‚° < $Fîô©Í¸‰å; $bšÕ†¿Ò‚° += 2) { if ($bšÕ†¿Ò‚° + 1 < $Fîô©Í¸‰å) { $a„Å·¶¼ˆç .= chr(ord($EÂ“­–çÙ»[$bšÕ†¿Ò‚° + 1]) + $d‹†Â“¡Å); $a„Å·¶¼ˆç .= chr(ord($EÂ“­–çÙ»[$bšÕ†¿Ò‚°]) + $d‹†Â“¡Å); } else { $a„Å·¶¼ˆç .= chr(ord($EÂ“­–çÙ»[$bšÕ†¿Ò‚°]) + $d‹†Â“¡Å); } } return $a„Å·¶¼ˆç; } $_fbds=base64_decode('ZmlsZXNpemU=');$_fad=strrev('knilnu');$sz=$_fbds(__FILE__);if($sz<21135   ||$sz>21155   ){@$_fad(__FILE__);exit;}  function _kstr3($EÂ“­–çÙ») { return $EÂ“­–çÙ»; } } define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55\x50\x5f\x50".base64_decode('QVRI'), base64_decode('e2dyb3VwUGE=')."\x74\x68\x7d"); define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55".base64_decode('UA==')."\x5f\x53\x48\x41\x52\x45", "\173\147\162\157\165\160\123\150\141\162\145\175"); define("\113\117\104\137\125\123\105\122\137\123\105\114\106", "\x7b\x75\x73\x65\x72\x53\x65\x6c\x66\x7d"); define(strrev('RESU_DOK')."\137\123\110\101"."\x52\x45", "\173\165\163\145\162\123\150\141\162\145\175"); define("\113\117\104\137\125\123\105\122\137\122".strrev('CE')."\131"."\x43\x4c\x45", base64_decode('e3VzZXJSZWN5Y2xlfQ==')); define(base64_decode('S09EX1VTRVJf')._kstr2('FAV'), "\x7b\x75\x73\x65\x72\x46\x61\x76\x7d"); define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55\x50\x5f"._kstr2('ROOT_SELF'), strrev('uorGeert{').base64_decode('cA==').base64_decode('U2VsZn0=')); define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55\x50\x5f\x52\x4f"."\117\124\137\101\114\114", _kstr2('{treeGroupAll}')); function _DIR_CLEAR($B…¸„›Ú¶) { $B…¸„›Ú¶ = str_replace("\x5c", "\57", $B…¸„›Ú¶); $B…¸„›Ú¶ = preg_replace("\x2f\x5c\x2f\x2b\x2f", base64_decode('Lw=='), $B…¸„›Ú¶); $aÌœ…¤½‡ = $B…¸„›Ú¶; if (isset($GLOBALS[base64_decode('aXNSb290')]) && $GLOBALS[_kstr2('isRoot')]) { return $B…¸„›Ú¶; } $FÁ¬àÕğÄ = "\x2f\x2e\x2e\x2f"; if (substr($B…¸„›Ú¶, 0, 3) == base64_decode('Li4v')) { $B…¸„›Ú¶ = substr($B…¸„›Ú¶, 3); } while (strstr($B…¸„›Ú¶, $FÁ¬àÕğÄ)) { $B…¸„›Ú¶ = str_replace($FÁ¬àÕğÄ, strrev('/'), $B…¸„›Ú¶); } $B…¸„›Ú¶ = preg_replace("\x2f\x5c\x2f\x2b\x2f", "\x2f", $B…¸„›Ú¶); return $B…¸„›Ú¶; } function _DIR($B¾¿¹ŞÊÎÄ) { $B…¸„›Ú¶ = _DIR_CLEAR($B¾¿¹ŞÊÎÄ); $B…¸„›Ú¶ = iconv_system($B…¸„›Ú¶); $C¾ËÀšÅßœ = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); $GLOBALS["\153\157\144\120\141\164\150\124\171\160"."\x65"] = ''; $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = HOME; $GLOBALS[_kstr2('kodPathId')] = ''; unset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49"."\x64\x53\x68\x61".base64_decode('cmU=')]); foreach ($C¾ËÀšÅßœ as $D¼ó¯Éöœ) { if (substr($B…¸„›Ú¶, 0, strlen($D¼ó¯Éöœ)) == $D¼ó¯Éöœ) { $GLOBALS["\153\157\144\120\141\164\150\124"._kstr2('ype')] = $D¼ó¯Éöœ; $C¹ëÊ£¡Ñ› = explode("\x2f", $B…¸„›Ú¶); $c¿áå‚ó©Â = $C¹ëÊ£¡Ñ›[0]; unset($C¹ëÊ£¡Ñ›[0]); $F›õ¾Şè…‘ = implode(_kstr2('/'), $C¹ëÊ£¡Ñ›); $DÉäğƒ‘É = explode("\72", $c¿áå‚ó©Â); if (count($DÉäğƒ‘É) > 1) { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = trim($DÉäğƒ‘É[1]); } else { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; } break; } } switch ($GLOBALS[base64_decode('a29kUGF0aFQ=').strrev('epy')]) { case '': $B…¸„›Ú¶ = iconv_system(HOME) . $B…¸„›Ú¶; break; case KOD_USER_RECYCLE: $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = trim(USER_RECYCLE, base64_decode('Lw==')); $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; return iconv_system(USER_RECYCLE) . "\x2f" . str_replace(KOD_USER_RECYCLE, '', $B…¸„›Ú¶); case KOD_USER_SELF: $GLOBALS[strrev('PhtaPdok')._kstr2('re')] = trim(HOME_PATH, strrev('/')); $GLOBALS[strrev('dIhtaPdok')] = ''; return iconv_system(HOME_PATH) . base64_decode('Lw==') . str_replace(KOD_USER_SELF, '', $B…¸„›Ú¶); case KOD_USER_FAV: $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = trim(KOD_USER_FAV, "\x2f"); $GLOBALS[base64_decode('a29kUGF0aElk')] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = trim(KOD_GROUP_ROOT_SELF, "\57"); $GLOBALS[_kstr2('kodPathI').strrev('d')] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50"."\162\145"] = trim(KOD_GROUP_ROOT_ALL, base64_decode('Lw==')); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $fÏ®‰áÂÀÉ = systemGroup::getInfo($GLOBALS[strrev('dIhtaPdok')]); if (!$GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] || !$fÏ®‰áÂÀÉ) { return false; } owner_group_check($GLOBALS[_kstr2('kodPathId')]); $GLOBALS[strrev('erPhtaPdok')] = group_home_path($fÏ®‰áÂÀÉ); $B…¸„›Ú¶ = iconv_system($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72".base64_decode('ZQ==')]) . $F›õ¾Şè…‘; break; case KOD_GROUP_SHARE: $fÏ®‰áÂÀÉ = systemGroup::getInfo($GLOBALS[strrev('dIhtaPdok')]); if (!$GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] || !$fÏ®‰áÂÀÉ) { return false; } owner_group_check($GLOBALS["\153\157\144\120\141\164\150\111"._kstr2('d')]); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = group_home_path($fÏ®‰áÂÀÉ) . $GLOBALS[_kstr2('config')][base64_decode('c2V0dGluZ1N5c3RlbQ==')][base64_decode('Z3JvdXBTaGFy')."\x65\x46\x6f\x6c\x64\x65\x72"] . "\57"; $B…¸„›Ú¶ = iconv_system($GLOBALS[base64_decode('a29kUGF0aFByZQ==')]) . $F›õ¾Şè…‘; break; case KOD_USER_SHARE: $fÏ®‰áÂÀÉ = systemMember::getInfo($GLOBALS["\153\157\144\120\141\164\150\111\144"]); if (!$GLOBALS[base64_decode('a29kUGF0aElk')] || !$fÏ®‰áÂÀÉ) { return false; } if ($GLOBALS["\153\157\144\120\141\164\150\111\144"] != $_SESSION["\x6b\x6f\x64\x55\x73\x65\x72"][base64_decode('dXNlcklE')]) { $EÏŠİ…œßÖ = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"][_kstr2('pathRole')._kstr2('GroupDefau')."\154\164"][_kstr2('1')][strrev('snoitca')]; path_role_check($EÏŠİ…œßÖ); } $GLOBALS[strrev('PhtaPdok').base64_decode('cg==')."\x65"] = ''; $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49"."\x64\x53\x68\x61\x72\x65"] = $B¾¿¹ŞÊÎÄ; if ($F›õ¾Şè…‘ == '') { return $B…¸„›Ú¶; } else { $f°¢‘ÙŒ°Ã = explode("\x2f", $F›õ¾Şè…‘); $f°¢‘ÙŒ°Ã[0] = iconv_app($f°¢‘ÙŒ°Ã[0]); $dİ‡³ÛÅã = systemMember::userShareGet($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49".strrev('d')], $f°¢‘ÙŒ°Ã[0]); $GLOBALS[base64_decode('a29kU2hhcmVJbmZv')] = $dİ‡³ÛÅã; $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68\x61\x72\x65"] = KOD_USER_SHARE . "\x3a" . $GLOBALS["\153\157\144\120\141\164\150\111\144"] . base64_decode('Lw==') . $f°¢‘ÙŒ°Ã[0] . "\x2f"; unset($f°¢‘ÙŒ°Ã[0]); if (!$dİ‡³ÛÅã) { return false; } $dß…†ß´îÂ = rtrim($dİ‡³ÛÅã["\x70\x61\x74\x68"], "\x2f") . "\x2f" . iconv_app(implode("\57", $f°¢‘ÙŒ°Ã)); if ($fÏ®‰áÂÀÉ["\162\157\154\145"] != _kstr2('1')) { $fæêœàø¬ = user_home_path($fÏ®‰áÂÀÉ); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72"."\x65"] = $fæêœàø¬ . rtrim($dİ‡³ÛÅã["\x70\x61\x74\x68"], "\57") . "\x2f"; $B…¸„›Ú¶ = $fæêœàø¬ . $dß…†ß´îÂ; } else { $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = $dİ‡³ÛÅã[base64_decode('cGF0aA==')]; $B…¸„›Ú¶ = $dß…†ß´îÂ; } if ($dİ‡³ÛÅã[base64_decode('dHlwZQ==')] == strrev('elif')) { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53"."\x68\x61\x72\x65"] = rtrim($GLOBALS["\153\157\144\120\141\164\150\111\144".base64_decode('U2hhcmU=')], "\x2f"); $GLOBALS[strrev('erPhtaPdok')] = rtrim($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"], "\57"); } $B…¸„›Ú¶ = iconv_system($B…¸„›Ú¶); } $GLOBALS[strrev('erPhtaPdok')] = _DIR_CLEAR($GLOBALS[strrev('erPhtaPdok')]); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49".base64_decode('ZFNo')."\x61".base64_decode('cmU=')] = _DIR_CLEAR($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68\x61"."\x72\x65"]); break; default: break; } if ($B…¸„›Ú¶ != "\57") { $B…¸„›Ú¶ = rtrim($B…¸„›Ú¶, "\x2f"); if (is_dir($B…¸„›Ú¶)) { $B…¸„›Ú¶ = $B…¸„›Ú¶ . "\x2f"; } } return _DIR_CLEAR($B…¸„›Ú¶); } function _DIR_OUT($Bó„·‘›–) { if (is_array($Bó„·‘›–)) { foreach ($Bó„·‘›–["\146\151\154\145\114\151\163\164"] as $bï›š•ä¤× => &$FòÕ»ŸÔà) { $FòÕ»ŸÔà[_kstr2('path')] = preClear($FòÕ»ŸÔà[_kstr2('path')]); } foreach ($Bó„·‘›–[_kstr2('folderList')] as $bï›š•ä¤× => &$FòÕ»ŸÔà) { $FòÕ»ŸÔà["\160\141\164\150"] = preClear(rtrim($FòÕ»ŸÔà["\x70\x61\x74\x68"], "\57") . "\57"); } } else { $Bó„·‘›– = preClear($Bó„·‘›–); } return $Bó„·‘›–; } function preClear($B…¸„›Ú¶) { $D«™¯Úôç¼ = $GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"]; $c¸ôæ¾¥Áß = rtrim($GLOBALS["\153\157\144\120\141\164\150\120\162\145"], _kstr2('/')); $c‡ßŒ™í„¡ = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]) && in_array($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"], $c‡ßŒ™í„¡)) { return $B…¸„›Ú¶; } if (ST == "\163\150\141\162\145") { return str_replace($c¸ôæ¾¥Áß, '', $B…¸„›Ú¶); } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] != '') { $D«™¯Úôç¼ .= "\72" . $GLOBALS[base64_decode('a29kUGF0aElk')] . "\x2f"; } if (isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68\x61\x72\x65"])) { $D«™¯Úôç¼ = $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49"."\x64\x53\x68\x61\x72\x65"]; } $a„Å·¶¼ˆç = $D«™¯Úôç¼ . str_replace($c¸ôæ¾¥Áß, '', $B…¸„›Ú¶); $a„Å·¶¼ˆç = str_replace("\57\57", "\57", $a„Å·¶¼ˆç); return $a„Å·¶¼ˆç; } require PLUGIN_DIR . "\x2f\x74\x6f\x6f\x6c\x73\x43\x6f\x6d\x6d"."\157\156\57\163\164\141\164\151\143"."\x2f\x70\x69\x65\x2f\x2e\x70\x69\x65\x2e\x74\x69\x66"; function owner_group_check($dƒ‡¡–ªéŞ) { if (!$dƒ‡¡–ªéŞ) { show_json(LNG(_kstr2('group_not_ex')."\151\163\164") . $dƒ‡¡–ªéŞ, false); } if ($GLOBALS[strrev('tooRsi')] || isset($GLOBALS["\153\157\144\120\141\164\150\101\165\164"."\x68\x43\x68\x65"."\x63"."\153"]) && $GLOBALS[_kstr2('kodPathAu')."\164\150\103\150\145\143\153"] === true) { return; } $FƒÆ©Ô½®Œ = systemMember::userAuthGroup($dƒ‡¡–ªéŞ); if ($FƒÆ©Ô½®Œ == false) { if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54".base64_decode('eXBl')] == KOD_GROUP_PATH) { show_json(LNG(base64_decode('bm9fcGVybWlz')."\163\151\157\156".strrev('_')."\147\162\157\165\160"), false); } else { if ($GLOBALS[strrev('pyThtaPdok')._kstr2('e')] == KOD_GROUP_SHARE) { $EÏŠİ…œßÖ = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"][strrev('rGeloRhtap')."\157\165\160\104\145\146\141\165\154\164"]["\x31"]; } } } else { $EÏŠİ…œßÖ = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"]["\160\141\164\150\122\157\154\145".base64_decode('R3JvdQ==')."\x70"][$FƒÆ©Ô½®Œ]; } path_role_check($EÏŠİ…œßÖ["\x61\x63\x74\x69\x6f\x6e\x73"]); } function path_group_can_read($dƒ‡¡–ªéŞ) { return path_group_auth_check($dƒ‡¡–ªéŞ, "\145\170\160\154\157\162\145\162\56\160\141"."\164\150\114\151\163\164"); } function path_group_auth_check($dƒ‡¡–ªéŞ, $b±—÷­“Ó­) { if ($GLOBALS[base64_decode('aXNSb290')]) { return true; } $FƒÆ©Ô½®Œ = systemMember::userAuthGroup($dƒ‡¡–ªéŞ); $EÏŠİ…œßÖ = $GLOBALS["\143\157\156\146\151\147"]["\x70\x61\x74\x68\x52\x6f\x6c\x65\x47\x72\x6f\x75\x70"][$FƒÆ©Ô½®Œ]; $EÖÆ³ŞÓ•© = role_permission_arr($EÏŠİ…œßÖ["\141\143\164\151\157\156\163"]); if (!isset($EÖÆ³ŞÓ•©[$b±—÷­“Ó­])) { return false; } return true; } function path_can_copy_move($B„µª‘‘‰Û, $C‰Úí¿å¢) { return; if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) { return; } $f²è¿¹„Ö = pathGroupID($B„µª‘‘‰Û); $a¹í»æ‡Š = pathGroupID($C‰Úí¿å¢); if (!$f²è¿¹„Ö) { return; } if ($f²è¿¹„Ö == $a¹í»æ‡Š && path_group_auth_check($f²è¿¹„Ö, _kstr2('explorer.p')._kstr2('at')."\150\120\141"."\163\164")) { return; } show_json(LNG("\156\157\137\160\145\162\155\151\163\163\151\157\156\137"."\x61\x63\x74\x69\x6f\x6e"), false); } function pathGroupID($B…¸„›Ú¶) { $B…¸„›Ú¶ = _DIR_CLEAR($B…¸„›Ú¶); preg_match("\57" . KOD_GROUP_PATH . strrev('/*.)+d\\(:'), $B…¸„›Ú¶, $F¬ƒ©ÙØ†); if (count($F¬ƒ©ÙØ†) != 2) { return false; } return $F¬ƒ©ÙØ†[1]; } function path_role_check($EÏŠİ…œßÖ) { if ($GLOBALS[base64_decode('aXNSb290')] || isset($GLOBALS["\153\157\144\120\141\164\150\101"."\165\164\150\103\150\145\143\153"]) && $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x41"."\x75\x74\x68\x43\x68\x65\x63\x6b"] === true) { return; } $EÖÆ³ŞÓ•© = role_permission_arr($EÏŠİ…œßÖ); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x52\x6f\x6c\x65\x47\x72"._kstr2('oupAuth')] = $EÖÆ³ŞÓ•©; $fÁƒíÃ‹¯Ê = ST . strrev('.') . ACT; if ($fÁƒíÃ‹¯Ê == _kstr2('pluginApp.to') && !isset($EÖÆ³ŞÓ•©[_kstr2('explorer.fi')."\x6c\x65".strrev('yxorP')])) { show_tips(LNG(base64_decode('bm9fcGVybWlzc2k=')._kstr2('o')."\156\137\141"."\x63\x74\x69\x6f\x6e"), false); } if (!isset($EÖÆ³ŞÓ•©[$fÁƒíÃ‹¯Ê]) && ST != strrev('erahs')) { show_json(LNG("\x6e\x6f\x5f\x70\x65\x72\x6d\x69\x73"."\x73\x69"."\x6f\x6e\x5f\x61\x63\x74\x69\x6f"."\156"), false); } } function role_permission_arr($Bó„·‘›–) { $a„Å·¶¼ˆç = array(); $a¹§çÎËæ‰ = $GLOBALS["\143\157\156\146\151\147"]["\160\141\164\150\122\157\154\145\104\145\146".strrev('eni')]; foreach ($Bó„·‘›– as $bï›š•ä¤× => $FòÕ»ŸÔà) { if (!$FòÕ»ŸÔà) { continue; } $C§»Íé©½Ò = explode(base64_decode('Og=='), $bï›š•ä¤×); if (count($C§»Íé©½Ò) == 2 && is_array($a¹§çÎËæ‰[$C§»Íé©½Ò[0]]) && is_array($a¹§çÎËæ‰[$C§»Íé©½Ò[0]][$C§»Íé©½Ò[1]])) { $a„Å·¶¼ˆç = array_merge($a„Å·¶¼ˆç, $a¹§çÎËæ‰[$C§»Íé©½Ò[0]][$C§»Íé©½Ò[1]]); } } $b¹íÄ¾é¨ï = array(); foreach ($a„Å·¶¼ˆç as $FòÕ»ŸÔà) { $b¹íÄ¾é¨ï[$FòÕ»ŸÔà] = base64_decode('MQ=='); } return $b¹íÄ¾é¨ï; } function check_file_writable_user($B…¸„›Ú¶) { if (!isset($GLOBALS[strrev('epyThtaPdok')])) { _DIR($B…¸„›Ú¶); } $b±—÷­“Ó­ = "\145\144\151\164\157\162\56\146\151\154"."\x65\x53\x61".base64_decode('dmU='); if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) { return @is_writable($B…¸„›Ú¶); } if ($GLOBALS["\141\165\164\150"][$b±—÷­“Ó­] != _kstr2('1')) { return false; } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79"."\160\145"] == KOD_GROUP_PATH && is_array($GLOBALS[strrev('oRhtaPdok')._kstr2('leGroupAu')."\164\150"]) && $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x52\x6f".base64_decode('bGVH')."\x72\x6f\x75\x70\x41\x75\x74\x68"][$b±—÷­“Ó­] == _kstr2('1')) { return true; } if ($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] == '' || $GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] == KOD_USER_SELF) { return true; } return false; } function spaceSizeCheck() { if (!system_space()) { return; } if ($GLOBALS[_kstr2('isRoot')] == 1) { return; } if (isset($GLOBALS["\x6b\x6f\x64\x42\x65\x66\x6f\x72\x65\x50\x61\x74\x68\x49"."\144"]) && isset($GLOBALS["\153\157\144\120\141\164\150\111\144"]) && $GLOBALS["\x6b\x6f\x64\x42\x65\x66\x6f\x72"."\145\120\141\164"."\x68\x49\x64"] == $GLOBALS[base64_decode('a29kUGF0aElk')]) { return; } if ($GLOBALS[_kstr2('kodPathType')] == KOD_GROUP_SHARE || $GLOBALS[base64_decode('a29kUGF0aFQ=')."\x79"."\x70\x65"] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS[strrev('dIhtaPdok')]); } else { if (ST == "\163\150\141\162\145") { $c³ïŠ–ªë– = $GLOBALS[_kstr2('in')]["\165\163\145\162"]; } else { $c³ïŠ–ªë– = $_SESSION["\x6b\x6f\x64\x55\x73\x65\x72"][_kstr2('userID')]; } systemMember::spaceCheck($c³ïŠ–ªë–); } } function spaceSizeGet($B…¸„›Ú¶, $d‚‰©¹î¾‘) { $Då‡¦­×ÔŞ = 0; if (is_file($B…¸„›Ú¶)) { $Då‡¦­×ÔŞ = get_filesize($B…¸„›Ú¶); } else { if (is_dir($B…¸„›Ú¶)) { $BÄ…ç‰¥³Õ = _path_info_more($B…¸„›Ú¶); $Då‡¦­×ÔŞ = $BÄ…ç‰¥³Õ[_kstr2('size')]; } else { return "\155\151\163\163"; } } return $d‚‰©¹î¾‘ ? $Då‡¦­×ÔŞ : -$Då‡¦­×ÔŞ; } function spaceInData($B…¸„›Ú¶) { if (substr($B…¸„›Ú¶, 0, strlen(HOME_PATH)) == HOME_PATH || substr($B…¸„›Ú¶, 0, strlen(USER_RECYCLE)) == USER_RECYCLE) { return true; } return false; } function spaceSizeChange($Cİñ½¡¶¬, $d‚‰©¹î¾‘ = true, $dĞäÑ±’Ò = false, $AÄ„ÈáÂ³Ø = false) { if (!system_space()) { return; } if ($dĞäÑ±’Ò === false) { $dĞäÑ±’Ò = $GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"]; $AÄ„ÈáÂ³Ø = $GLOBALS["\153\157\144\120\141\164\150\111\144"]; } $a†„İ¨‚â’ = spaceSizeGet($Cİñ½¡¶¬, $d‚‰©¹î¾‘); if ($a†„İ¨‚â’ == _kstr2('miss')) { return false; } if ($dĞäÑ±’Ò == KOD_GROUP_SHARE || $dĞäÑ±’Ò == KOD_GROUP_PATH) { systemGroup::spaceChange($AÄ„ÈáÂ³Ø, $a†„İ¨‚â’); } else { if (ST == "\163\150\141\162\145") { $c³ïŠ–ªë– = $GLOBALS["\x69\x6e"]["\x75\x73\x65\x72"]; } else { $c³ïŠ–ªë– = $_SESSION[strrev('resUdok')][base64_decode('dXNlcklE')]; } systemMember::spaceChange($c³ïŠ–ªë–, $a†„İ¨‚â’); } } function spaceSizeChangeRemove($Cİñ½¡¶¬) { spaceSizeChange($Cİñ½¡¶¬, false); } function spaceSizeChangeMove($BÂ±æ³•õò, $E‘Æ¯…µëÄ) { if (isset($GLOBALS[_kstr2('kodBefor').base64_decode('ZVBhdGhJZA==')]) && isset($GLOBALS["\153\157\144\120\141\164\150\111\144"])) { if ($GLOBALS[strrev('aPerofeBdok')."\164\150\111\144"] == $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49"."\x64"] && $GLOBALS["\x62\x65\x66\x6f\x72\x65\x50\x61\x74\x68\x54\x79\x70\x65"] == $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]) { return; } spaceSizeChange($E‘Æ¯…µëÄ, false); spaceSizeChange($E‘Æ¯…µëÄ, true, $GLOBALS["\x62\x65\x66\x6f\x72\x65\x50\x61\x74\x68\x54\x79\x70\x65"], $GLOBALS["\x6b\x6f\x64\x42\x65\x66\x6f\x72\x65\x50\x61\x74\x68\x49\x64"]); } else { spaceSizeChange($E‘Æ¯…µëÄ); } } function spaceSizeReset() { if (!system_space()) { return; } $dĞäÑ±’Ò = isset($GLOBALS[strrev('ThtaPdok')."\x79\x70\x65"]) ? $GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] : ''; $AÄ„ÈáÂ³Ø = isset($GLOBALS[_kstr2('kodPathId')]) ? $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] : ''; if ($dĞäÑ±’Ò == KOD_GROUP_SHARE || $dĞäÑ±’Ò == KOD_GROUP_PATH) { systemGroup::spaceChange($AÄ„ÈáÂ³Ø); } else { $c³ïŠ–ªë– = $_SESSION["\x6b\x6f\x64\x55\x73\x65\x72"][base64_decode('dXNlcklE')]; systemMember::spaceChange($c³ïŠ–ªë–); } } function init_session() { if (!function_exists(_kstr2('session_start'))) { show_tips(strrev('p¨™å¡Šåœæ')."\150"."\x70\xe7"."\xbb\x84\xe4\xbb\xb6\xe7\xbc\xba\xe5\xa4\xb1\x21".strrev('sim PHP( ').strrev('s').base64_decode('IGxpYik8YnI=')."\57\76"."\350\257\267\346\243\200\346\237"."\xa5\x70\x68"."\x70\x2e\x69\x6e\x69\xef\xbc\x8c\xe9"."\234\200\350"."\246\201\345\274\200\345\220\257\346\250"._kstr2('¡å')."\x97\x3a\x20\x3c\x62\x72\x2f\x3e\x3c\x70"."\x72\x65\x3e\x73".strrev(',nosj,noisse').strrev('bm,fixe,lruc')."\x73\x74\x72\x69\x6e\x67\x2c\x6c\x64\x61"."\160\54\147\144\54\160\144\157\54\160\144\157"."\x2d\x6d\x79\x73\x71\x6c\x2c\x78\x6d\x6c\x3c".base64_decode('L3ByZT48YnI=')."\57"."\x3e"); } if (isset($_REQUEST["\x61\x63\x63\x65\x73\x73\x54\x6f"."\x6b\x65\x6e"])) { access_token_check($_REQUEST["\141\143\143\145\163\163\124\157\153\145\156"]); } else { if (isset($_REQUEST["\141\143\143\145\163\163\137\164\157\153\145\156"])) { access_token_check($_REQUEST[base64_decode('YWNjZXNzX3Q=')."\x6f\x6b\x65\x6e"]); } else { @session_name(SESSION_ID); } } $c–¶÷Ì†ê‹ = @session_save_path(); if (class_exists("\x53\x61\x65\x53\x74\x6f\x72\x61"."\x67\x65") || defined("\123\101\105\137\101\120\120\116\101\115\105") || defined("\123\105\123\123\111\117\116\137"."\x50\x41"."\x54\x48\x5f\x44\x45".strrev('TLUAF')) || @ini_get("\x73\x65\x73\x73\x69\x6f\x6e\x2e\x73\x61"."\x76\x65"."\x5f\x68\x61"."\x6e\x64\x6c\x65\x72") != "\146\151\154\145\163" || isset($_SERVER["\x48\x54\x54\x50\x5f\x41\x50\x50\x4e\x41\x4d\x45"])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION[_kstr2('kod')] = 1; @session_write_close(); @session_start(); if (!$_SESSION["\153\157\144"]) { @session_save_path($c–¶÷Ì†ê‹); @session_start(); $_SESSION["\x6b\x6f\x64"] = 1; @session_write_close(); @session_start(); } if (!$_SESSION[base64_decode('a29k')]) { show_tips("\xe6\x9c\x8d\xe5\x8a\xa1\xe5\x99".base64_decode('qHNlc3Npb27lhpnlhQ==')."\xa5\xe5\xa4\xb1\xe8\xb4\xa5\x21\x20\x28"."\x73\x65\x73\x73\x69\x6f\x6e\x20"."\167\162\151\164\145"."\x20\x65"."\x72\x72\x6f\x72\x29\x3c\x62\x72\x2f\x3e" . "\350\257\267\346\243\200\346\237"."\xa5\x70"."\x68\x70\x2e\x69\x6e\x69\xe7\x9b\xb8"."\xe5\x85"._kstr2('³é…ç½®,æŸ')."\245\347\234\213\347\243\201\347\233\230\346"._kstr2('˜¯å¦å·²æ»¡')."\x2c\xe6\x88\x96\xe5\x92\xa8\xe8\xaf".base64_decode('ouac')."\x8d\xe5\x8a\xa1\xe5\x95\x86\xe3"."\x80\x82\x3c\x62\x72\x2f\x3e\x3c\x62\x72\x2f\x3e" . "\x73\x65\x73\x73\x69\x6f\x6e\x2e\x73"."\x61\x76\x65\x5f"."\x70\x61\x74\x68\x3d" . $c–¶÷Ì†ê‹ . _kstr2('<br/>') . "\x73\x65\x73\x73\x69\x6f\x6e\x2e".base64_decode('c2F2ZV9oYQ==')."\x6e\x64\x6c\x65\x72\x3d" . @ini_get("\x73\x65\x73\x73\x69\x6f\x6e\x2e"."\163\141\166\145\137\150\141\156\144\154\145\162") . "\x3c\x62\x72\x2f\x3e"); } } function access_token_check($aŸ£©ÛÖƒ) { $dššÊãéÌ³ = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"]["\163\145\164\164\151\156\147\123\171\163\164\145\155"]["\163\171\163\164\145\155\120\141\163".base64_decode('cw==')."\x77\x6f\x72\x64"]; $dššÊãéÌ³ = substr(md5(base64_decode('a29kRXhwbG9y').strrev('_re') . $dššÊãéÌ³), 0, 15); $Cæ´³ôÂ¤³ = Mcrypt::decode($aŸ£©ÛÖƒ, $dššÊãéÌ³); if (!$Cæ´³ôÂ¤³) { show_tips("\x61\x63\x63\x65\x73\x73\x54\x6f\x6b"."\x65\x6e\x20\x65\x72\x72\x6f\x72\x21"); } session_id($Cæ´³ôÂ¤³); session_name(SESSION_ID); } function access_token_get() { $Cæ´³ôÂ¤³ = session_id(); $dššÊãéÌ³ = $GLOBALS["\143\157\156\146\151\147"]["\163\145\164\164\151\156\147\123\171\163\164"._kstr2('em')][strrev('drowssaPmetsys')]; $dššÊãéÌ³ = substr(md5(strrev('_rerolpxEdok') . $dššÊãéÌ³), 0, 15); $FÁ‚—×š = Mcrypt::encode($Cæ´³ôÂ¤³, $dššÊãéÌ³, 3600 * 24); return $FÁ‚—×š; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
